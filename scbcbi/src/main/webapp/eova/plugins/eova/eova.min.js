/**
 * EovaUI 1.6.0
 *
 * Copyright (c) 2014-2018 eova.cn All rights reserved.
 *
 * Eova exclusive, do not use for other projects without authorization.
 * For use with other projects, please contact us: admin@eova.cn
 *
 */
(function(b){b.extend({isNull:function(b){return void 0==b||null==b||""==b||""==b||"undefined"==b||"null"==b||"NULL"==b?!0:!1}});b.str={format:function(b){for(var a=0;a<arguments.length-1;a++)b=b.replace("{"+a+"}",arguments[a+1]);return b},clip:function(b,a){var c="",d=0;if(!b)return c;for(var e=0;e<b.length;e++){var f=b.charAt(e),d=0<=f.charCodeAt()&&128>=f.charCodeAt()?d+1:d+2;if(d>a)return c+"...";c+=f}return c},isNum:function(b){return null!=b&&0<b.length&&0==isNaN(b)?!0:!1},isCn:function(b){return/^([u4E00-u9FA5]|[uFE30-uFFA0])*$/.test(b)?!1:!0},encodeUrl:function(b){return encodeURIComponent(b)}};b.math={percent:function(b,a){return Math.round(b/a*1E4)/100+"%"},random:function(b,a){return Math.max(Math.min(Math.round(Math.random()*(a-b)+b),a),b)}};b.json={toObj:function(b){return JSON.parse(b)},toStr:function(b){return JSON.stringify(b)}};b.time={format:function(b){var a=new Date;a.setTime(b);b=a.getFullYear();var c=10>a.getMonth()+1?"0"+(a.getMonth()+1):a.getMonth()+1,d=10>a.getDate()?"0"+a.getDate():a.getDate(),e=10>a.getHours()?"0"+a.getHours():a.getHours(),f=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes(),a=10>a.getSeconds()?"0"+a.getSeconds():a.getSeconds();return b+"-"+c+"-"+d+" "+e+":"+f+":"+a},toWeek:function(b){return b instanceof Date?"\u661f\u671f\u5929 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" ")[b.getDay()]:"Param error,date type!"}};b.verify={rules:{number:[/^\d+$/,"\u8bf7\u586b\u5199\u6570\u5b57"],a_z:[/^[a-z]+$/i,"\u8bf7\u586b\u5199\u5b57\u6bcd"],date:[/^\d{4}-\d{2}-\d{2}$/,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u65e5\u671f\uff0c\u683c\u5f0f:yyyy-mm-dd"],time:[/^([01]\d|2[0-3])(:[0-5]\d){1,2}$/,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u65f6\u95f4\uff0c00:00\u523023:59\u4e4b\u95f4"],email:[/^[\w\+\-]+(\.[\w\+\-]+)*@[a-z\d\-]+(\.[a-z\d\-]+)*\.([a-z]{2,4})$/i,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u90ae\u7bb1"],url:[/^(https?|s?ftp):\/\/\S+$/i,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u7f51\u5740"],qq:[/^[1-9]\d{4,}$/,"\u8bf7\u586b\u5199\u6709\u6548\u7684QQ\u53f7"],idcard:[/^\d{6}(19|2\d)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)?$/,"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\u7801"],tel:[/^(?:(?:0\d{2,3}[\- ]?[1-9]\d{6,7})|(?:[48]00[\- ]?[1-9]\d{6}))$/,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u7535\u8bdd\u53f7\u7801"],mobile:[/^1[3-9]\d{9}$/,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u624b\u673a\u53f7"],zipcode:[/^\d{6}$/,"\u8bf7\u68c0\u67e5\u90ae\u653f\u7f16\u7801\u683c\u5f0f"],chinese:[/^[\u0391-\uFFE5]+$/,"\u8bf7\u586b\u5199\u4e2d\u6587\u5b57\u7b26"],account:[/^\w{3,12}$/,"\u8bf7\u586b\u51993-12\u4f4d\u6570\u5b57\u3001\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf"],password:[/^[\S]{6,16}$/,"\u8bf7\u586b\u51996-16\u4f4d\u5b57\u7b26\uff0c\u4e0d\u80fd\u5305\u542b\u7a7a\u683c"],money:[/^(?!0\.00)(?:0|[1-9]\d*)(?:\.\d{1,2})?$/,"\u8bf7\u586b\u5199\u6709\u6548\u7684\u91d1\u989d"]},rule:function(b){alert(b)}}})(jQuery);(function(b){function g(a,c,d){if(a&&null!=a){var e=b.getWidgetType(a);"datagrid"==e?d?a.datagrid(c,d):a.datagrid(c):"treegrid"==e&&(d?a.treegrid(c,d):a.treegrid(c))}}b.extend({I18N:function(a){if(!b.eova.i18n)return a;var c=b.eova.i18n[a];return c?c:a},extendPrototype:function(b,c){var a=function(){};a.prototype=c.prototype;b.prototype=new a;b.prototype.constructor=b},getHtmlOptions:function(b){var a=void 0;(b=b.$dom.data("options"))&&(a=eval("({"+b+"})"));return a},getDomOptions:function(b){var a={};if(b=b.$dom.attr("url"))a.url=b;return a},fuck:function(b){b.attr("readonly","readonly");b.css({background:"rgba(218, 218, 218, 0.4)"});b.unbind()},eovaInit:function(a,c,d,e){var f=[];a.each(function(){var a=b.data(this,d);a||(a=new c(this,e),b.data(this,d,a));f.push(a)});return 1==f.length?f[0]:f},eovaAutoHeight:function(b,c){b=b.width();b=parseInt(b/290);if(0!=b){var a=parseInt(c/b);0<c%b&&a++;return 40+25*a}},widgetReLoad:function(b,c){g(b,"reload",c)},widgetLoad:function(b,c){g(b,"load",c)},getWidgetType:function(b){var a="datagrid";-1!=b.context.URL.indexOf("/single_tree")&&(a="treegrid");return a},getWidgetSelected:function(a){var c=b.getWidgetType(a);if("datagrid"==c)return a.datagrid("getSelected");if("treegrid"==c)return a.treegrid("getSelected")},getWidgetSelections:function(a){var c=b.getWidgetType(a);if("datagrid"==c)return a.datagrid("getSelections");if("treegrid"==c)return a.treegrid("getSelections")},widgetClearSelections:function(a){var c=b.getWidgetType(a);if("datagrid"==c)return a.datagrid("clearSelections");if("treegrid"==c)return a.treegrid("clearSelections")},tipwarn:function(a,c){var d=a.tooltip({position:"bottom",deltaY:-6,showEvent:null,hideEvent:"mousemove",content:'\x3cspan\x3e\x3cspan class\x3d"pd5 icon-exclamation"\x3e\x26nbsp;\x3c/span\x3e'+c+"\x3c/span\x3e",onShow:function(){b(this).tooltip("tip").css({border:"1px solid transparent","background-color":"#fffcef","border-color":"#ffbb76",color:"#db7c22"})}}).tooltip("show");setTimeout(function(){d.tooltip("destroy")},3E3);return d},validation:function(a,c){if(!c.isValid){var d=b.tipwarn(b(c.element).parent(),c.msg);b(c.element).keydown(function(a){d.tooltip("destroy");b(this).unbind("keydown")})}},slideMsg:function(a,c){var d=b;c&&(d=c);d.messager.show({title:b.I18N("\u64cd\u4f5c\u63d0\u793a"),msg:a,timeout:1500,showType:"slide"})},alert:function(a,c){c&&null!=c&&""!=c||(c="\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01");c.startsWith("info")?(c=c.replace("info:",""),a.messager.alert(b.I18N("\u63d0\u793a"),c,"info")):c.startsWith("warn")?(c=c.replace("warn:",""),a.messager.alert(b.I18N("\u8b66\u544a"),c,"warning")):(c.startsWith("error")&&(c=c.replace("error:","")),a.messager.alert(b.I18N("\u9519\u8bef"),c,"error"))},dialog:function(a,c,d,e,f){e||(e=945);f||(f=.9*b(window).height());var l=d.replace(/\//g,"_"),h=l.indexOf("?");-1!=h&&(l=l.substring(0,h-1));var k=parent.sy.modalDialog({id:l,title:c,url:d,buttons:[{id:"eovaSave",text:"\x26nbsp;\x26nbsp;"+b.I18N("\u4fdd\u5b58")+"\x26nbsp;\x26nbsp;",handler:function(){k.find("iframe").get(0).contentWindow.btnSaveCallback(k,a,parent.$)}},{id:"eovaCancel",text:"\x26nbsp;\x26nbsp;"+b.I18N("\u53d6\u6d88")+"\x26nbsp;\x26nbsp;",handler:function(){k.dialog("close")}}]},e,f),m=k.find("iframe").get(0).contentWindow;b(m).keyup(function(b){switch(b.keyCode){case 27:k.dialog("close")}}).keypress(function(b){!b.ctrlKey||10!=b.keyCode&&13!=b.keyCode||m.btnSaveCallback(k,a,parent.$)})},gridToExcel:function(){var b=function(b,a){return b.replace(/{(\w+)}/g,function(b,d){return a[d]})};return function(a,d){for(var c="\x3ctr\x3e",f=a.datagrid("getColumnFields"),l=0;l<f.length;l++){var h=f[l];console.log(h);"ck"!=h&&((h=a.datagrid("getColumnOption",h).title)||(h=""),c=c+"\x3ctd\x3e"+h+"\x3c/td\x3e")}c+="\x3c/tr\x3e";a=a.datagrid("getRows");for(var k=0;k<a.length;k++){var m=a[k];console.log(m);c+="\x3ctr\x3e";for(l=0;l<f.length;l++)h=f[l],"ck"!=h&&(c=c+"\x3ctd\x3e"+m[h]+"\x3c/td\x3e");c+="\x3c/tr\x3e"}window.location.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(b('\x3chtml xmlns:o\x3d"urn:schemas-microsoft-com:office:office" xmlns:x\x3d"urn:schemas-microsoft-com:office:excel" xmlns\x3d"http://www.w3.org/TR/REC-html40"\x3e\x3chead\x3e\x3c!--[if gte mso 9]\x3e\x3cxml\x3e\x3cx:ExcelWorkbook\x3e\x3cx:ExcelWorksheets\x3e\x3cx:ExcelWorksheet\x3e\x3cx:Name\x3e{worksheet}\x3c/x:Name\x3e\x3cx:WorksheetOptions\x3e\x3cx:DisplayGridlines/\x3e\x3c/x:WorksheetOptions\x3e\x3c/x:ExcelWorksheet\x3e\x3c/x:ExcelWorksheets\x3e\x3c/x:ExcelWorkbook\x3e\x3c/xml\x3e\x3c![endif]--\x3e\x3c/head\x3e\x3cbody\x3e\x3ctable\x3e{table}\x3c/table\x3e\x3c/body\x3e\x3c/html\x3e',{worksheet:d||"Worksheet",table:c}))))}}(),eovatab:function(b,c,d,e){b.addTab(d,c,e)}});b.extend(b.fn.datagrid.defaults.editors,{eovatext:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-text" name\x3d"'+c.name+'"\x3e\x3c/div\x3e').appendTo(a);a.eovatext(c);return a},getValue:function(a){return b(a).eovatext().getValue()},setValue:function(a,c){b(a).eovatext().setValue(c)},resize:function(a,c){b(a).eovatext().setWidth(c)}},eovatime:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-time"\x3e\x3c/div\x3e').appendTo(a);a.eovatime(c);return a},getValue:function(a){return b(a).eovatime().getValue()},setValue:function(a,c){b(a).eovatime().setValue(c)},resize:function(a,c){b(a).eovatime().setWidth(c)}},eovacombo:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-combo"\x3e\x3c/div\x3e').appendTo(a);a.eovacombo(c);return a},destroy:function(a){b(a).eovacombo().destroy()},getText:function(a){return b(a).eovacombo().getText()},getValue:function(a){return b(a).eovacombo().getValue()},setValue:function(a,c){var d=[];c&&""!=c&&(d=-1==c.indexOf(",")?[c]:c.split(","));b(a).eovacombo().setTexts(d)},resize:function(a,c){b(a).eovacombo().setWidth(c)}},eovacombotree:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-combo-tree"\x3e\x3c/div\x3e').appendTo(a);a.eovacombo(c);return a},destroy:function(a){b(a).eovacombotree().destroy()},getText:function(a){return b(a).eovacombotree().getText()},getValue:function(a){return b(a).eovacombotree().getValue()},setValue:function(a,c){var d=[];c&&""!=c&&(d=-1==c.indexOf(",")?[c]:c.split(","));b(a).eovacombo().setTexts(d)},resize:function(a,c){b(a).eovacombotree().setWidth(c)}},eovafind:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-find"\x3e\x3c/div\x3e').appendTo(a);a.eovafind(c);return a},getText:function(a){return b(a).eovafind().getText()},getValue:function(a){return b(a).eovafind().getValue()},setValue:function(a,c){b(a).eovafind().setText(c)},resize:function(a,c){b(a).eovafind().setWidth(c)}},eovabool:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-bool"\x3e\x3c/div\x3e').appendTo(a);a.eovabool(c);return a},getValue:function(a){return b(a).eovabool().getChecked()},setValue:function(a,c){b(a).eovabool().setChecked(c)},resize:function(b,c){}},eovainfo:{init:function(a,c){a=b('\x3cdiv class\x3d"eova-info"\x3e\x3c/div\x3e').appendTo(a);a.eovainfo(c);return a},getValue:function(a){return b(a).eovainfo().getValue()},setValue:function(a,c){b(a).eovainfo().setValue(c)},resize:function(a,c){b(a).eovainfo().setWidth(c)}}});b.extend(b.fn.datagrid.methods,{editCell:function(a,c){return a.each(function(){b(this).datagrid("options");for(var a=b(this).datagrid("getColumnFields",!0).concat(b(this).datagrid("getColumnFields")),e=0;e<a.length;e++){var f=b(this).datagrid("getColumnOption",a[e]);f.editor1=f.editor;a[e]!=c.field&&(f.editor=null)}b(this).datagrid("beginEdit",c.index);(e=b(this).datagrid("getEditor",c))&&(b(e.target).hasClass("textbox-f")?b(e.target).textbox("textbox").focus():b(e.target).focus());for(e=0;e<a.length;e++)f=b(this).datagrid("getColumnOption",a[e]),f.editor=f.editor1})},enableCellEditing:function(a){return a.each(function(){var a=b(this),d=a.datagrid("options");d.oldOnClickCell=d.onClickCell;d.onClickCell=function(c,f){if(void 0!=d.editIndex)if(a.datagrid("validateRow",d.editIndex)){if(!b("#"+d.id).parent().isValid())return;a.datagrid("endEdit",d.editIndex);d.editIndex=void 0}else return;a.datagrid("selectRow",c).datagrid("editCell",{index:c,field:f});d.editIndex=c;d.oldOnClickCell.call(this,c,f)}})}});b.fn.mask=function(a){a||(a=22);1!=b(this).data("mask")&&(a='\x3cdiv class\x3d"divMask" style\x3d"position: absolute; width: 100%; height: '+a+'px; left: 0px; top: 1px; background: rgba(218, 218, 218, 0.4);z-index: 8999"\x3e \x3c/div\x3e',b(this).wrap('\x3cspan style\x3d"position: relative;font-size:16px;"\x3e\x3c/span\x3e'),b(this).parent().append(a),b(this).data("mask",1))};b.fn.unmask=function(){1==b(this).data("mask")&&(b(this).parent().find(".divMask").remove(),b(this).unwrap(),b(this).data("mask",0))}})(jQuery);var EovaWidget=function(){var b={object:{},fields:{},config:{}};return{data:b,init:function(g,a,c,d){a&&""!=a?b.object=JSON.parse(a):$.syncGetJson("/meta/object/"+g,function(a){b.object=a});c&&""!=c?b.fields=JSON.parse(c):$.syncGetJson("/meta/fields/"+g,function(a){b.fields=a});d&&""!=d&&(b.config=JSON.parse(d))}}}();(function(b){TEXTBOX="textbox";b.fn.eovatext=function(a){var c=[];this.each(function(){var d=b.data(this,TEXTBOX);d?b.extend(d.options,a):(d=new g(this,a),d.render(),d.bindEvents());b.data(this,TEXTBOX,d);c.push(d)});return 1==c.length?c[0]:c};var g=b.fn.eovatext.TextBox=function(a,c){this.$dom=b(a);this.defaults={width:180,btnTitle:"\u70b9\u51fb\u6e05\u7a7a\u6587\u672c",btnIcon:"",isReadonly:!1,disable:!1,required:!1,onChange:function(b){}};this.options=b.extend({},this.defaults,b.getHtmlOptions(this),c);this.name=this.$dom.attr("name");this.$dom.removeAttr("name");this.value=this.$dom.attr("value");this.$dom.removeAttr("value")};g.prototype.render=function(){var a=b("\x3cinput type\x3d'text' autocomplete\x3d'off' /\x3e").appendTo(this.$dom),c=b("\x3ci class\x3d'ei'\x3e\x3c/i\x3e").appendTo(this.$dom);c.attr("title",this.options.btnTitle);this.name&&a.attr("name",this.name);this.value&&a.attr("value",this.value);this.options.placeholder&&a.attr("placeholder",this.options.placeholder);this.options.required&&a.attr("required","required");this.options.isReadonly?b.fuck(a):c.attr("title",this.options.btnTitle);this.$textbox=a;this.$btn=c;this.setWidth(this.options.width)};g.prototype.bindEvents=function(){var b=this.$textbox,c=this.$dom,d=this.options;d.isReadonly||this.$btn.bind("click",function(){b.val("")});var e=!1;b.bind("propertychange input",function(){e||(e=!0,setTimeout(function(){d.onChange.call(c,b.val());e=!1},500))})};g.prototype.getValue=function(){return this.$textbox.val()};g.prototype.setValue=function(b){this.$textbox.val(b)};g.prototype.getWidth=function(){return this.options.width+20};g.prototype.setWidth=function(b){this.$textbox.outerWidth(b-22)};g.prototype.readonly=function(a){a&&b.fuck($textbox)}})(jQuery);(function(b){var g=b.fn.eovatext.TextBox;FINDBOX="findbox";b.fn.eovafind=function(d){var c=[];this.each(function(){var e=b.data(this,FINDBOX);e?b.extend(e.options,d):(e=new a(this,d),e.render(),e.bindEvents(),e.init());b.data(this,FINDBOX,e);c.push(e)});return 1==c.length?c[0]:c};var a=b.fn.eovafind.FindBox=function(a,c){g.apply(this,arguments);this.defaults={btnTitle:"\u70b9\u51fb\u67e5\u627e\u5185\u5bb9",isReadonly:!1,multiple:!1,separator:",",url:void 0,exp:void 0,onChange:function(b,a,c){}};this.options=b.extend({},this.options,this.defaults,b.getDomOptions(this),b.getHtmlOptions(this),c);this.code=this.$dom.attr("code");this.$dom.removeAttr("code");this.field=this.$dom.attr("field");this.$dom.removeAttr("field")};b.extendPrototype(a,g);a.prototype.render=function(){var a=b("\x3cinput type\x3d'hidden' /\x3e").appendTo(this.$dom),c=b("\x3cinput type\x3d'text' /\x3e").appendTo(this.$dom),f=b("\x3ci class\x3d'ei'\x3e\x3c/i\x3e").appendTo(this.$dom);this.name&&a.attr("name",this.name);this.value&&a.val(this.value);this.options.placeholder&&c.attr("placeholder",this.options.placeholder);this.options.required&&c.attr("required","required");c.attr("readonly","readonly");this.options.isReadonly?c.css({background:"rgba(218, 218, 218, 0.4)"}):(c.css("cursor","pointer"),c.attr("title",this.options.btnTitle),f.attr("title",this.options.btnTitle));this.$valuebox=a;this.$textbox=c;this.$btn=f;this.setWidth(this.options.width);console.log("\u7b80\u5355\u624d\u662f\u9ad8\u79d1\u6280\uff0c\u56e0\u4e3a\u7b80\u5355\u6240\u4ee5\u66f4\u5feb\uff1a http://www.eova.cn/")};a.prototype.init=function(){var a=this.$textbox;if(this.getValue()){var c=b.str.format("/widget/findCnByEn?val\x3d{0}",this.getValue()),c=this.options.exp?c+b.str.format("\x26exp\x3d{0}",this.options.exp):c+b.str.format("\x26code\x3d{0}\x26field\x3d{1}",this.code,this.field);b.ajax({url:c,dataType:"json",success:function(c){if(0==c.code)a.val(c.data);else{var d=c.text_field,e=[];b.each(eval(c.data),function(b,a){e.push(a[d])});a.val(e.join(","))}}})}};a.prototype.bindEvents=function(){var b=this,a=this.$textbox;this.options.isReadonly||(this.$textbox.bind("click",function(){c(b)}),this.$btn.bind("click",function(){a.trigger("click")}))};a.prototype.getValue=function(){return this.$valuebox.val()};a.prototype.setValue=function(b){this.$valuebox.val(b);this.init()};a.prototype.getText=function(){return this.$textbox.val()};a.prototype.setText=function(b){this.$textbox.val(b)};a.prototype.getUrl=function(){var a=this.options.url;this.options.exp&&(a="/widget/find?exp\x3d"+this.options.exp);this.options.multiple&&(a=b.appendUrlPara(a,"multiple",this.options.multiple));return a=b.appendUrlPara(a,"val",this.getValue())};var c=function(a){var c=parent.sy.modalDialog({id:"eova_find_dialog",title:b.I18N("\u8bf7\u9009\u62e9\u6570\u636e"),url:a.getUrl(),buttons:[{id:"find_clear",text:b.I18N("\u6e05\u7a7a\u9009\u62e9"),handler:function(){c.find("iframe").get(0).contentWindow.clearData(c,a);window.focus()}},{id:"find_ok",text:b.I18N("\u786e\u5b9a"),handler:function(){c.find("iframe").get(0).contentWindow.selectData(c,a);window.focus()}}]},650,600)}})(jQuery);(function(b){function g(a,c){var e=a.options;a.$panel.empty();e.multiple||b('\x3cdiv value\x3d""\x3e\x3c/div\x3e').appendTo(a.$panel);b.each(c,function(c,d){c=d[e.textField];c=b.str.clip(c,40);b('\x3cdiv value\x3d"'+d[e.valueField]+'"\x3e'+c+"\x3c/div\x3e").appendTo(a.$panel)});a.$panel.children("div").unbind(".eovacombo").bind("mousedown.eovacombo",function(c){var f=b(this),l=f.attr("value");if(e.multiple)if(f.hasClass("eova-combo-selected"))for(var f=a.getValues(),h=0;h<f.length;h++){if(f[h]==l){f.splice(h,1);a.setValues(f);break}}else d(a,l);else d(a,l),a.$panel.hide();c.stopPropagation()});a.getValue()&&(e.multiple?a.setValues(a.getValues()):a.setValue(a.getValue()));b.data(a,COMBOBOX,a)}function a(a){var c=a.$textbox,d=a.$panel,e=c.offset();d.css({position:"absolute",height:200,overflow:"auto",width:a.$dom.width()});d.show();d.css({left:function(){var a=e.left;a+d.outerWidth()>b(window).outerWidth()+b(document).scrollLeft()&&(a=b(window).outerWidth()+b(document).scrollLeft()-d.outerWidth());0>a&&(a=0);return a}()-1,top:function(){var a=e.top+c.outerHeight();a+d.outerHeight()>b(window).outerHeight()+b(document).scrollTop()&&(a=e.top-d.outerHeight());a<b(document).scrollTop()&&(a=e.top+c.outerHeight());return a}()})}function c(a){var c=a.$textbox.val().toLowerCase();a.$panel.children().removeClass("eova-combo-hide");""==c?a.setValue(""):a.$panel.children().map(function(){-1==b(this).text().toLowerCase().indexOf(c)&&b(this).addClass("eova-combo-hide")})}function d(b,a){if(b.options.multiple){for(var c=b.getValues(),d=0;d<c.length;d++)if(c[d]==a)return;c.push(a);b.setValues(c)}else b.setValues([a])}var e=b.fn.eovatext.TextBox;COMBOBOX="combobox";b.fn.eovacombo=function(a){var c=[];this.each(function(){var d=b.data(this,COMBOBOX);d?b.extend(d.options,a):(d=new f(this,a),d.render(),d.reload(),d.bindEvents());b.data(this,COMBOBOX,d);c.push(d)});return 1==c.length?c[0]:c};var f=b.fn.eovacombo.ComboBox=function(a,c){e.apply(this,arguments);this.defaults={btnTitle:"\u70b9\u51fb\u9009\u62e9\u5185\u5bb9",btnIcon:"",isReadonly:!1,multiple:!1,separator:",",editable:!0,valueField:"id",textField:"cn",url:void 0,exp:void 0,json:void 0,onChange:function(b,a){}};this.options=b.extend({},this.options,this.defaults,b.getDomOptions(this),b.getHtmlOptions(this),c)};b.extendPrototype(f,e);f.prototype.render=function(){var a=b("\x3cinput type\x3d'hidden' /\x3e").appendTo(this.$dom),c=b("\x3cinput type\x3d'text' /\x3e").appendTo(this.$dom),d=b("\x3ci class\x3d'ei'\x3e\x3c/i\x3e").appendTo(this.$dom),e=b("\x3cdiv class\x3d'eova-combo-panel'\x3e\x3c/div\x3e").appendTo("body");e.css("cursor","pointer");this.name&&a.attr("name",this.name);this.value&&a.attr("value",this.value);this.options.placeholder&&c.attr("placeholder",this.options.placeholder);this.options.required&&c.attr("required","required");this.options.isReadonly?b.fuck(c):d.attr("title",this.options.btnTitle);this.$valuebox=a;this.$textbox=c;this.$btn=d;this.$panel=e;this.setWidth(this.options.width)};f.prototype.bindEvents=function(){var d=this,e=this.$textbox,f=this.$panel;if(!this.options.isReadonly){f.unbind(".eovacombo");this.$dom.click(function(b){a(d);b.stopPropagation()});f.bind("mousedown.eovacombo",function(a){return!1});b(document).unbind(".eovacombo").bind("mousedown.eovacombo",function(a){b(".eova-combo-panel").is(":visible")&&b(".eova-combo-panel").hide()});var g=!1;e.bind("propertychange input",function(){g||(g=!0,setTimeout(function(){console.log("combo input event");c(d);g=!1},100))})}};f.prototype.destroy=function(){this.$dom.remove();this.$panel.remove()};f.prototype.reload=function(){var a=this;if(this.options.json)g(a,this.options.json);else{var c=this.$dom.attr("url");this.options.url&&(c=this.options.url);this.options.exp&&(c="/widget/comboJson?exp\x3d"+this.options.exp);c?b.ajax({type:"get",async:!0,url:c,dataType:"json",success:function(b){g(a,b)},error:function(){alert("\u4e0b\u62c9\u6846\u52a0\u8f7d\u6570\u636e\u5931\u8d25,URL\x3d"+c)}}):b("\x3cdiv\x3e\u6570\u636e\u672a\u52a0\u8f7d\x3c/div\x3e").appendTo(a.$panel)}};f.prototype.getValue=function(){return this.$valuebox.val()};f.prototype.getValues=function(){var a=this.$valuebox.val();return""==a?[]:a.split(this.options.separator)};f.prototype.setValue=function(a){this.setValues([a])};f.prototype.setValues=function(a){this.$panel.children().removeClass("eova-combo-selected");for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d],f=this.$panel.children("div[value\x3d'"+e+"']");""!=f.text()&&(b.push(e),c.push(f.text()),f.addClass("eova-combo-selected"))}d=this.getValues();this.$valuebox.val(b.join(this.options.separator));this.$textbox.val(c.join(this.options.separator));b=this.options;b.multiple?a.length!=d.length&&b.onChange.call(this.$dom,d,a):a[0]!=d[0]&&b.onChange.call(this.$dom,d[0],a[0])};f.prototype.getText=function(){return this.$textbox.val()};f.prototype.getTexts=function(){var a=this.$textbox.val();return""==a?[]:a.split(this.options.separator)};f.prototype.setText=function(a){return this.setTexts([a])};f.prototype.setTexts=function(a){this.$panel.children().removeClass("eova-combo-selected");for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d],f=this.$panel.children("div:contains('"+e+"')");b.push(f.attr("value"));c.push(e);f.addClass("eova-combo-selected")}a=this.getValues();this.$valuebox.val(b.join(this.options.separator));this.$textbox.val(c.join(this.options.separator));c=this.options;c.multiple?b.length!=a.length&&c.onChange.call(this.$dom,a,values):b[0]!=a[0]&&c.onChange.call(this.$dom,a[0],b[0])}})(jQuery);(function(b){function g(a,c){var d=a.options;a.$panel.empty();var e=b.fn.zTree.init(a.$panel,{data:{key:{name:d.nameField},simpleData:{enable:!0,idKey:d.idField,pIdKey:d.pidField,rootPId:d.rootPId}},check:{enable:d.multiple},callback:{onClick:function(b,c,d){d.id!=a.getValue()?a.setValue(d.id):(a.setValue(),e.refresh());a.$panel.hide()},onCheck:function(b,c,d){if(d.checked)a:if(b=d.id,a.options.multiple){c=a.getValues();for(d=0;d<c.length;d++)if(c[d]==b)break a;c.push(b);a.setValues(c)}else a.setValues([b]);else for(b=d.id,c=a.getValues(),d=0;d<c.length;d++)if(c[d]==b){c.splice(d,1);a.setValues(c);break}}}},c);e.expandNode(d.rootPId,!0,!1,!0);a.$tree=e;a.getValue()&&(d.multiple?a.setValues(a.getValues()):a.setValue(a.getValue()));b.data(a,COMBOTREE,a)}var a=b.fn.eovacombo.ComboBox;COMBOTREE="combotree";b.fn.eovacombotree=function(a){var d=[];this.each(function(){var e=b.data(this,COMBOTREE);e?b.extend(e.options,a):(e=new c(this,a),e.render(),e.reload(),e.bindEvents());b.data(this,COMBOTREE,e);d.push(e)});return 1==d.length?d[0]:d};var c=b.fn.eovacombotree.ComboTree=function(c,e){a.apply(this,arguments);this.defaults={btnTitle:"\u70b9\u51fb\u9009\u62e9\u6811\u8282\u70b9",btnIcon:"",isReadonly:!1,multiple:!1,separator:",",idField:"id",pidField:"pid",nameField:"name",iconField:"iconskip",rootPId:0,url:void 0,exp:void 0,json:void 0,onChange:function(a,b){}};this.options=b.extend({},this.options,this.defaults,b.getDomOptions(this),b.getHtmlOptions(this),e)};b.extendPrototype(c,a);c.prototype.render=function(){var a=b("\x3cinput type\x3d'hidden' /\x3e").appendTo(this.$dom),c=b("\x3cinput type\x3d'text' /\x3e").appendTo(this.$dom),f=b("\x3ci class\x3d'ei'\x3e\x3c/i\x3e").appendTo(this.$dom),g=b("\x3cdiv id\x3d'ztree_"+this.name+"' class\x3d'eova-combotree-panel ztree'\x3e\x3c/div\x3e").appendTo("body");g.css("cursor","pointer");this.name&&a.attr("name",this.name);this.value&&a.attr("value",this.value);this.options.placeholder&&c.attr("placeholder",this.options.placeholder);this.options.required&&c.attr("required","required");this.options.isReadonly?b.fuck(c):(c.attr("readonly","readonly"),c.css("cursor","pointer"),c.attr("title",this.options.btnTitle),f.attr("title",this.options.btnTitle));this.$valuebox=a;this.$textbox=c;this.$btn=f;this.$panel=g;this.setWidth(this.options.width)};c.prototype.bindEvents=function(){var a=this.$textbox,c=this.$panel;this.options.isReadonly||(c.unbind(".eovacombotree"),this.$dom.click(function(d){b(".eova-combotree-panel").is(":visible")&&b(".eova-combotree-panel").hide();var e=a.offset();c.css({position:"absolute",left:e.left-1,top:e.top+21,height:200,overflow:"auto",width:b(this).width()});c.show();d.stopPropagation()}),c.bind("mousedown.eovacombotree",function(a){return!1}),b(document).unbind(".eovacombotree").bind("mousedown.eovacombotree",function(a){b(".eova-combotree-panel").is(":visible")&&b(".eova-combotree-panel").hide()}))};c.prototype.reload=function(){var a=this;if(this.options.json)g(a,this.options.json);else{var c=this.$dom.attr("url");this.options.url&&(c=this.options.url);this.options.exp&&(c="/widget/comboTreeJson?exp\x3d"+this.options.exp);(c=b.appendUrlPara(c,"multiple",this.options.multiple))?b.ajax({type:"get",async:!0,url:c,dataType:"json",success:function(b){g(a,b)},error:function(){alert("\u52a0\u8f7d\u6570\u636e\u5931\u8d25,URL\x3d"+c)}}):b("\x3cdiv\x3e\u6570\u636e\u672a\u52a0\u8f7d\x3c/div\x3e").appendTo(a.$panel)}};c.prototype.setValues=function(a){for(var b=[],c=[],d=0;d<a.length;d++){var g=a[d],k=this.$tree.getNodeByParam("id",g,null),m="\u8bf7\u9009\u62e9";null!=k&&(m=k.name,this.$tree.selectNode(k,!0));b.push(g);c.push(m)}d=this.getValues();this.$valuebox.val(b.join(this.options.separator));this.$textbox.val(c.join(this.options.separator));b=this.options;b.multiple?a.length!=d.length&&b.onChange.call(this.$dom,d,a):a[0]!=d[0]&&b.onChange.call(this.$dom,d[0],a[0])};c.prototype.setTexts=function(a){for(var b=[],c=[],d=0;d<a.length;d++){var g=a[d],k=this.$tree.getNodeByParam("name",g,null);this.$tree.selectNode(k,!0);b.push(k.id);c.push(g)}a=this.getValues();this.$valuebox.val(b.join(this.options.separator));this.$textbox.val(c.join(this.options.separator));c=this.options;c.multiple?b.length!=a.length&&c.onChange.call(this.$dom,a,values):b[0]!=a[0]&&c.onChange.call(this.$dom,a[0],b[0])}})(jQuery);(function(b){BOOLBOX="boolbox";b.fn.eovabool=function(a){var c=[];this.each(function(){var d=b.data(this,BOOLBOX);d?b.extend(d.options,a):(d=new g(this,a),d.render());b.data(this,BOOLBOX,d);c.push(d)});return 1==c.length?c[0]:c};var g=b.fn.eovabool.BoolBox=function(a,c){this.$dom=b(a);this.defaults={isCheck:!1,isReadonly:!1};a=void 0;var d=this.$dom.data("options");d&&(a=eval("({"+d+"})"),this.$dom.removeAttr("data-options"));this.options=b.extend({},this.defaults,a,c);this.name=this.$dom.attr("name");this.value=this.$dom.attr("value")};g.prototype.render=function(){var a=b("\x3cinput type\x3d'checkbox' /\x3e").appendTo(this.$dom);this.name&&a.attr("name",this.name);this.value&&a.attr("value",this.value);this.options.isCheck&&this.setChecked(!0);this.options.isReadonly&&a.attr("disabled","disabled");this.$boolbox=a};g.prototype.getChecked=function(){return this.$boolbox.prop("checked")};g.prototype.setChecked=function(a){this.$boolbox.prop("checked",a)};g.prototype.readonly=function(a){a&&this.$boolbox.attr("readonly",!0)}})(jQuery);(function(b){var g=b.fn.eovatext.TextBox;ICONBOX="iconbox";b.fn.eovaicon=function(c){var d=[];this.each(function(){var e=b.data(this,ICONBOX);e?b.extend(e.options,c):(e=new a(this,c),e.render(),e.bindEvents());b.data(this,ICONBOX,e);d.push(e)});return 1==d.length?d[0]:d};var a=b.fn.eovaicon.IconBox=function(a,c){g.apply(this,arguments);this.defaults={btnTitle:"\u70b9\u51fb\u9009\u62e9\u56fe\u6807",isReadonly:!1};this.options=b.extend({},this.options,this.defaults,c)};b.extendPrototype(a,g);var c=function(a,b){var c=parent.sy.modalDialog({id:"icon_dialog",title:"\u4fee\u6539ICON",url:"/toIcon",buttons:[{id:"icon_ok",text:"\u4fee\u6539",handler:function(){c.find("iframe").get(0).contentWindow.selectIcon(c,a,b);window.focus()}}]},572,390)};a.prototype.bindEvents=function(){var a=this.$textbox,b=this.$btn;this.options.isReadonly?a.attr("readonly","readonly"):(b.bind("click",function(){b.addClass("ext-icon-zoom");c(a,b)}),this.$textbox.bind("click",function(){b.trigger("click")}))}})(jQuery);(function(b){var g=b.fn.eovatext.TextBox;b.fn.eovainfo=function(c){var d=[];this.each(function(){var e=b.data(this,"infobox");e?b.extend(e.options,c):(e=new a(this,c),e.render(),e.bindEvents());b.data(this,"infobox",e);d.push(e)});return 1==d.length?d[0]:d};var a=b.fn.eovainfo.InfoBox=function(a,c){g.apply(this,arguments);this.defaults={btnTitle:"\u70b9\u51fb\u7f16\u8f91\u4fe1\u606f",isReadonly:!1};this.options=b.extend({},this.options,this.defaults,c)};b.extendPrototype(a,g);var c=function(a){var c=a.val();c&&(-1!=c.indexOf("function")&&-1!=c.indexOf("return")?c=js_beautify(c,4):(c=c.replace(/<%/g,"\n\x3c%"),c=c.replace(/%>/g,"%\x3e\n")));var d=parent.sy.modalDialog({id:"eova-info-text-dlg",title:"\u5feb\u901f\u7f16\u8f91",content:'\x3ctextarea id\x3d"eova-info-text" class\x3d"eova-info-text"\x3e'+c+"\x3c/textarea\x3e",buttons:[{text:" \u786e \u5b9a ",handler:function(){(c=parent.$("#eova-info-text").val())&&-1!=c.indexOf("function")&&-1!=c.indexOf("return")&&(c=b.compressWhiteSpace(c));a.val(c);d.dialog("destroy")}}]},650,410);b.autoFocus(parent.$("#eova-info-text"))};a.prototype.bindEvents=function(){var a=this.$textbox,b=this.$btn;b.bind("click",function(){c(a)});this.$textbox.bind("click",function(){b.trigger("click")})}})(jQuery);(function(b){var g=b.fn.eovatext.TextBox;TIMEBOX="timebox";b.fn.eovatime=function(c){var d=[];this.each(function(){var e=b.data(this,TIMEBOX);e?b.extend(e.options,c):(e=new a(this,c),e.render(),e.bindEvents());b.data(this,TIMEBOX,e);d.push(e)});return 1==d.length?d[0]:d};var a=b.fn.eovatime.TimeBox=function(a,d){g.apply(this,arguments);this.defaults={btnTitle:"\u70b9\u51fb\u9009\u62e9\u65f6\u95f4",isReadonly:!1,format:"yyyy-MM-dd HH:mm:ss"};this.options=b.extend({},this.options,this.defaults,b.getHtmlOptions(this),d)};b.extendPrototype(a,g);a.prototype.bindEvents=function(){var a=this.$textbox;this.options.isReadonly||(this.$btn.bind("click",function(){a.trigger("click")}),this.$dom.attr("onClick","WdatePicker({dateFmt:'"+this.options.format+"'})"))}})(jQuery);$(function(){setTimeout(function(){if(navigator.onLine){var b=$(".footer a"),g=b.data("app");g&&$.ajax({url:"//www.eova.cn/api/live/"+g,type:"post",data:{copyright:b.text()},error:function(){}})}},18E5)});(function(b){var g=b.fn.eovatext.TextBox;AUTOBOX="autobox";b.fn.eovaauto=function(c){var d=[];this.each(function(){var e=b.data(this,AUTOBOX);e?b.extend(e.options,c):(e=new a(this,c),e.render(),e.$textbox.css("background-color","#EBEBE4"),e.bindEvents());b.data(this,AUTOBOX,e);d.push(e)});return 1==d.length?d[0]:d};var a=b.fn.eovaauto.AutoBox=function(a,d){g.apply(this,arguments);this.defaults={btnTitle:"\u81ea\u589e\u957f\u5b57\u6bb5",disable:!0};this.options=b.extend({},this.options,this.defaults,d)};b.extendPrototype(a,g);a.prototype.bindEvents=function(){}})(jQuery);(function(b){CHECKBOX="checkbox";b.fn.eovacheck=function(a){var c=[];this.each(function(){var d=b.data(this,CHECKBOX);d?b.extend(d.options,a):(d=new g(this,a),d.render());b.data(this,CHECKBOX,d);c.push(d)});return 1==c.length?c[0]:c};var g=b.fn.eovacheck.CheckBox=function(a,c){this.$dom=b(a);this.defaults={isCheck:!1,disable:!1};a=void 0;var d=this.$dom.data("options");d&&(a=eval("({"+d+"})"),this.$dom.removeAttr("data-options"));this.options=b.extend({},this.defaults,a,c);this.name=this.$dom.attr("name");this.value=this.$dom.attr("value")};g.prototype.render=function(){var a=b("\x3cinput type\x3d'checkbox' /\x3e").appendTo(this.$dom);this.name&&a.attr("name",this.name);this.value&&a.attr("value",this.value);this.options.isCheck&&this.setChecked(!0);this.options.disable&&a.attr("disabled","disabled");this.$checkbox=a};g.prototype.getChecked=function(){return this.$checkbox.prop("checked")};g.prototype.setChecked=function(a){this.$checkbox.prop("checked",a)};g.prototype.readonly=function(a){a&&this.$checkbox.attr("readonly",!0)}})(jQuery);
//# sourceMappingURL=eova.min.js.map
